# Base Schema

This document defines the `Core` interface used across multiple microservices. It represents a fundamental building block for shared data entities.

## Overview

The `Core` interface is a common base for all entities within the system. 
It provides core metadata and versioning information for tracking and managing data. 
It's designed to be extended by more specific entity interfaces to add business-specific properties. 
This promotes consistency and enables standardized handling of common tasks like auditing, access control, and versioning.

## Property Details

| Property      | Type         | Required | Description                                                                                                                                                             | DTO                                       | Schema                              | Serializer | Validation                                | Example                                        |
| ------------- | ------------ | -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------- | ----------------------------------- | ---------- | ----------------------------------------- | ---------------------------------------------- |
| `id`          | `string`     | Yes      | Unique identifier for the core entity. This is a Mongo Id and the primary key.                                                                                          | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `ref`         | `string`     | No       | A reference identifier Useful for external system integration.                                                                                                          | `Expose`, `IsOptional`,                   | `Unique`, `Optional`                | `Expose`   | ___                                       | `ORD-20231027-001`                             |
| `owner`       | `string`     | Yes      | The `user` or `app` or `client` ID that initially created and has primary responsibility for the entity.                                                                | `Expose`, `IsOptional`                    | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `a2c4e567b9012653b8a5e057`                     |
| `shares`      | `string[]`   | No       | List of user IDs that owner allows to them to access to own entities.                                                                                                   | `Expose`, `IsOptional`                    | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `["653b8a5e057a2c4e567b9012"]`                 |
| `groups`      | `string[]`   | No       | List of `Mongo IDs` or `Emails` or `FQDN` with access to the entity. Used for group-based access control. Each data has two group when generate(client domain,  app id) | `Expose`, `IsOptional`,                   | `Optional`                          | `Expose`   | ___                                       | `["exp@mail.com", "653b8a5e057a2c4e567b9012"]` |
| `clients`     | `string[]`   | Yes      | List of client IDs that have access to the entity. By default, when an entity is created, its own client ID is included in this list.                                   | `Expose`, `IsOptional`                    | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `["653b8a5e057a2c4e567b9012"]`                 |
| `created_at`  | `Date`       | Yes      | Timestamp indicating when the entity was created.                                                                                                                       | `Expose`, `ApiHideProperty`,              | `Auto Generated`                    | `Expose`   | `IsDate`                                  | `2023-10-27T10:00:00.000Z`                     |
| `created_by`  | `string`     | Yes      | The `user` or `app` or `client` ID that create entity.                                                                                                                  | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `created_in`  | `string`     | Yes      | The `client` where the entity was created.                                                                                                                              | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `updated_at`  | `Date`       | No       | Timestamp indicating when the entity was last updated.                                                                                                                  | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsDate`                                  | `2023-10-27T11:00:00.000Z`                     |
| `updated_by`  | `string`     | No       | The `user` or `app` or `client` ID of the entity last updater.                                                                                                          | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `updated_in`  | `string`     | No       | The `client` where the entity was last updated.                                                                                                                         | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `deleted_at`  | `Date`       | No       | Timestamp indicating when the entity was deleted. It's a soft delete.                                                                                                   | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsDate`                                  | `2023-10-27T12:00:00.000Z`                     |
| `deleted_by`  | `string`     | No       | The `user` or `app` or `client` ID  of the entity deleter.                                                                                                              | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `deleted_in`  | `string`     | No       | The `client` where the entity was deleted.                                                                                                                              | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `restored_at` | `Date`       | No       | Timestamp indicating when the entity was restored.                                                                                                                      | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsDate`                                  | `2023-10-27T13:00:00.000Z`                     |
| `restored_by` | `string`     | No       | The `user` or `app` or `client` ID of the entity restorer.                                                                                                              | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `restored_in` | `string`     | No       | The `client` where the entity was restored.                                                                                                                             | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `description` | `string`     | No       | A human-readable description of the entity. Useful for full text search in Mongo.                                                                                       | `Expose`, `IsOptional`                    | `Optional`                          | `Expose`   | ___                                       | `Order details for customer X`                 |
| `identity`    | `string`     | No       | An external identifier for the entity, potentially from another system.                                                                                                 | `Expose`, `IsOptional`                    | `Optional`                          | `Expose`   | `IsMongoId`                               | `653b8a5e057a2c4e567b9012`                     |
| `props`       | `Properties` | No       | A dynamic object containing business-specific properties. The type `Properties` can vary depending on the specific entity. In fact is a free schema.                    | `Expose`, `IsOptional`                    | `Optional`                          | `Expose`   | `IsObject`                                | `{ customerId: "cust123"}`                     |
| `tags`        | `string[]`   | No       | List of tags for categorizing the entity. It has a specific format.                                                                                                     | `Expose`, `IsOptional`                    | `Optional`                          | `Expose`   | TAG\_REGEX = `/^[\w\-._]+(:[\w\-._]+)?$/` | `["high-priority", "urgent"]`                  |
| `version`     | `string`     | Yes      | Version of the entity schema.  Used for schema evolution and compatibility. Platform change batch number with every change on data.                                     | `Expose`, `IsOptional`                    | `Auto Generated`, `default='1.0.0'` | `Expose`   | ___                                       | `1.0.0`                                        |
| `rand`        | `string`     | Yes      | Random string. Useful for create ids by this rand and timestamp.                                                                                                        | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | ___                                       | `abcdef1234567890`                             |
| `timestamp`   | `string`     | Yes      | Timestamp string. Used for tracking changes and create ids by this timestamp and rand.                                                                                  | `Expose`, `IsOptional`, `ApiHideProperty` | `Auto Generated`                    | `Expose`   | `IsDate`                                  | `2023-10-27T14:00:00.000Z`                     |
